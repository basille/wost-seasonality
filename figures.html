<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Manuscript figures | Joint seasonality in geographic and ecological spaces, illustrated with a partially migratory bird</title>
  <meta name="description" content="Study of seasonal patterns of wood stork, both in geographic space (distribution) and environmental space (climatic niche)." />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Manuscript figures | Joint seasonality in geographic and ecological spaces, illustrated with a partially migratory bird" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Study of seasonal patterns of wood stork, both in geographic space (distribution) and environmental space (climatic niche)." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Manuscript figures | Joint seasonality in geographic and ecological spaces, illustrated with a partially migratory bird" />
  
  <meta name="twitter:description" content="Study of seasonal patterns of wood stork, both in geographic space (distribution) and environmental space (climatic niche)." />
  

<meta name="author" content="Mathieu Basille, James Watling, Stephanie Romañach, Rena Borkhataria" />


<meta name="date" content="2019-10-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="niches.html"/>
<link rel="next" href="session.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="_custom.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Climatic niche in space and time</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>2</b> Data preprocessing</a><ul>
<li class="chapter" data-level="2.1" data-path="data.html"><a href="data.html#data-import-gps-and-raster-data"><i class="fa fa-check"></i><b>2.1</b> Data import: GPS and raster data</a></li>
<li class="chapter" data-level="2.2" data-path="data.html"><a href="data.html#environmental-intersection"><i class="fa fa-check"></i><b>2.2</b> Environmental intersection</a></li>
<li class="chapter" data-level="2.3" data-path="data.html"><a href="data.html#sampling-the-point-data"><i class="fa fa-check"></i><b>2.3</b> Sampling the point data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="niches.html"><a href="niches.html"><i class="fa fa-check"></i><b>3</b> Climatic niches in space and time</a><ul>
<li class="chapter" data-level="3.1" data-path="niches.html"><a href="niches.html#utilization-distributions"><i class="fa fa-check"></i><b>3.1</b> Utilization distributions</a></li>
<li class="chapter" data-level="3.2" data-path="niches.html"><a href="niches.html#monthly-climatic-niches"><i class="fa fa-check"></i><b>3.2</b> Monthly climatic niches</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="figures.html"><a href="figures.html"><i class="fa fa-check"></i><b>4</b> Manuscript figures</a><ul>
<li class="chapter" data-level="4.1" data-path="figures.html"><a href="figures.html#fig.1-monthly-ranges-and-climatic-niches"><i class="fa fa-check"></i><b>4.1</b> Fig.1: Monthly ranges and climatic niches</a></li>
<li class="chapter" data-level="4.2" data-path="figures.html"><a href="figures.html#fig.2-overlap-matrices"><i class="fa fa-check"></i><b>4.2</b> Fig.2: Overlap matrices</a></li>
<li class="chapter" data-level="4.3" data-path="figures.html"><a href="figures.html#fig.3-marginality"><i class="fa fa-check"></i><b>4.3</b> Fig.3: Marginality</a></li>
<li class="chapter" data-level="4.4" data-path="figures.html"><a href="figures.html#metadata-s1-animation-over-the-year"><i class="fa fa-check"></i><b>4.4</b> Metadata S1: Animation over the year</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="session.html"><a href="session.html"><i class="fa fa-check"></i><b>5</b> R session information</a></li>
<li class="chapter" data-level="6" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>6</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Joint seasonality in geographic and ecological spaces, illustrated with a partially migratory bird</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="figures" class="section level1">
<h1><span class="header-section-number">4</span> Manuscript figures</h1>
<p>This page provides the exact script for the manuscript’s figures.</p>
<div id="fig.1-monthly-ranges-and-climatic-niches" class="section level2">
<h2><span class="header-section-number">4.1</span> Fig.1: Monthly ranges and climatic niches</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">temp.range &lt;-<span class="st"> </span><span class="kw">range</span>(<span class="kw">as.vector</span>(rast[[(<span class="dv">1</span>:<span class="dv">12</span>)*<span class="dv">2</span>]]), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)
prec.range &lt;-<span class="st"> </span><span class="kw">range</span>(<span class="kw">as.vector</span>(rast[[(<span class="dv">1</span>:<span class="dv">12</span>)*<span class="dv">2-1</span>]]), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)

## Get legends
g1t &lt;-<span class="st"> </span><span class="kw">ggplot</span>() +
<span class="st">    </span><span class="kw">geom_raster</span>(<span class="dt">data =</span> rastDF, <span class="kw">aes_string</span>(<span class="dt">x =</span> <span class="st">&quot;x&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;y&quot;</span>, 
        <span class="dt">fill =</span> <span class="kw">names</span>(rastDF)[<span class="dv">4</span>])) +
<span class="st">    </span><span class="kw">scale_fill_viridis</span>(<span class="dt">end =</span> .<span class="dv">8</span>, <span class="dt">alpha =</span> <span class="dv">1</span>, <span class="dt">option =</span> <span class="st">&quot;plasma&quot;</span>, 
        <span class="dt">limits =</span> temp.range, <span class="dt">breaks =</span> (<span class="dv">1</span>:<span class="dv">8</span>)*<span class="dv">5</span>) +
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Latitude&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Longitude&quot;</span>, <span class="dt">fill =</span> 
        <span class="kw">expression</span>(<span class="st">&quot;Temperature &quot;</span> ( degree~C))) +
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;top&quot;</span>, <span class="dt">legend.justification =</span> <span class="st">&quot;center&quot;</span>) +
<span class="st">    </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colourbar</span>(<span class="dt">barwidth =</span> <span class="dv">15</span>, <span class="dt">barheight =</span> <span class="dv">1</span>, 
        <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">26</span>)))
temp_legend &lt;-<span class="st"> </span>cowplot::<span class="kw">get_legend</span>(g1t)
g1p &lt;-<span class="st"> </span><span class="kw">ggplot</span>() +
<span class="st">    </span><span class="kw">geom_raster</span>(<span class="dt">data =</span> rastDF, <span class="kw">aes_string</span>(<span class="dt">x =</span> <span class="st">&quot;x&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;y&quot;</span>,
        <span class="dt">fill =</span> <span class="kw">names</span>(rastDF)[<span class="dv">3</span>])) +
<span class="st">    </span><span class="kw">scale_fill_viridis</span>(<span class="dt">alpha =</span> <span class="dv">1</span>, <span class="dt">direction =</span> -<span class="dv">1</span>, <span class="dt">option =</span> <span class="st">&quot;cividis&quot;</span>, 
        <span class="dt">limits =</span> prec.range, <span class="dt">breaks =</span> (<span class="dv">1</span>:<span class="dv">8</span>)*<span class="dv">50</span>) +
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Latitude&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Longitude&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;Precipitation (mm)&quot;</span>) +
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;top&quot;</span>, <span class="dt">legend.justification =</span> <span class="st">&quot;center&quot;</span>) +
<span class="st">    </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colourbar</span>(<span class="dt">barwidth =</span> <span class="dv">14</span>, <span class="dt">barheight =</span> <span class="dv">1</span>, 
        <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">26</span>)))
prec_legend &lt;-<span class="st"> </span>cowplot::<span class="kw">get_legend</span>(g1p)

## Loop over all months:
for(i in <span class="dv">1</span>:<span class="dv">12</span>){
    plot_list &lt;-<span class="st"> </span><span class="kw">list</span>()
    plot_list[[<span class="dv">1</span>]] &lt;-
<span class="st">        </span><span class="kw">ggplot</span>() +
<span class="st">        </span><span class="kw">geom_raster</span>(<span class="dt">data =</span> rastDF, <span class="kw">aes_string</span>(<span class="dt">x =</span> <span class="st">&quot;x&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;y&quot;</span>, 
            <span class="dt">fill =</span> <span class="kw">names</span>(rastDF)[i*<span class="dv">2+2</span>])) +
<span class="st">        </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> states, <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">size =</span> .<span class="dv">2</span>, <span class="dt">colour =</span> <span class="kw">gray</span>(.<span class="dv">2</span>)) +
<span class="st">        </span><span class="kw">geom_point</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(wost), <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y),
            <span class="dt">shape =</span> <span class="dv">20</span>, <span class="dt">size =</span> .<span class="dv">8</span>, <span class="dt">stroke =</span> <span class="dv">0</span>, <span class="dt">colour =</span> <span class="st">&quot;gray&quot;</span>) +
<span class="st">        </span><span class="kw">geom_point</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(monthLocs[[i]]), <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y), 
            <span class="dt">shape =</span> <span class="dv">20</span>, <span class="dt">size =</span> .<span class="dv">3</span>) +
<span class="st">        </span><span class="kw">geom_contour</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(monthKerAll[[i]]), 
            <span class="kw">aes</span>(<span class="dt">x =</span> Var2, <span class="dt">y =</span> Var1, <span class="dt">z =</span> ud), <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>) +
<span class="st">        </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(-<span class="dv">92</span>, -<span class="fl">77.5</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="fl">24.5</span>, <span class="dv">35</span>), 
            <span class="dt">expand =</span> <span class="ot">FALSE</span>) +
<span class="st">        </span><span class="kw">scale_fill_viridis</span>(<span class="dt">end =</span> .<span class="dv">8</span>, <span class="dt">alpha =</span> <span class="dv">1</span>, <span class="dt">option =</span> <span class="st">&quot;plasma&quot;</span>, 
            <span class="dt">limits =</span> temp.range, <span class="dt">breaks =</span> (<span class="dv">1</span>:<span class="dv">8</span>)*<span class="dv">5</span>) +
<span class="st">        </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Latitude&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Longitude&quot;</span>, 
            <span class="dt">fill =</span> <span class="kw">expression</span>(<span class="st">&quot;Temperature &quot;</span> ( degree~C))) +
<span class="st">        </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)
    plot_list[[<span class="dv">2</span>]] &lt;-
<span class="st">        </span><span class="kw">ggplot</span>() +
<span class="st">        </span><span class="kw">geom_raster</span>(<span class="dt">data =</span> rastDF, <span class="kw">aes_string</span>(<span class="dt">x =</span> <span class="st">&quot;x&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;y&quot;</span>, 
            <span class="dt">fill =</span> <span class="kw">names</span>(rastDF)[i*<span class="dv">2+1</span>])) +
<span class="st">        </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> states, <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">size =</span> .<span class="dv">2</span>, <span class="dt">colour =</span> <span class="kw">gray</span>(.<span class="dv">2</span>)) +
<span class="st">        </span><span class="kw">geom_point</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(wost), <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y), 
            <span class="dt">shape =</span> <span class="dv">20</span>, <span class="dt">size =</span> .<span class="dv">8</span>, <span class="dt">stroke =</span> <span class="dv">0</span>, <span class="dt">colour =</span> <span class="st">&quot;gray&quot;</span>) +
<span class="st">        </span><span class="kw">geom_point</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(monthLocs[[i]]), <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y), 
            <span class="dt">shape =</span> <span class="dv">20</span>, <span class="dt">size =</span> .<span class="dv">3</span>) +
<span class="st">        </span><span class="kw">geom_contour</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(monthKerAll[[i]]), 
            <span class="kw">aes</span>(<span class="dt">x =</span> Var2, <span class="dt">y =</span> Var1, <span class="dt">z =</span> ud), <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>) +
<span class="st">        </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(-<span class="dv">92</span>, -<span class="fl">77.5</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="fl">24.5</span>, <span class="dv">35</span>), 
            <span class="dt">expand =</span> <span class="ot">FALSE</span>) +
<span class="st">        </span><span class="kw">scale_fill_viridis</span>(<span class="dt">alpha =</span> <span class="dv">1</span>, <span class="dt">direction =</span> -<span class="dv">1</span>, <span class="dt">option =</span> <span class="st">&quot;cividis&quot;</span>, 
            <span class="dt">limits =</span> prec.range, <span class="dt">breaks =</span> (<span class="dv">1</span>:<span class="dv">8</span>)*<span class="dv">50</span>) +
<span class="st">        </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Latitude&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Longitude&quot;</span>) +
<span class="st">        </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)
    plot_list[[<span class="dv">3</span>]] &lt;-
<span class="st">        </span><span class="kw">ggplot</span>(clim, <span class="kw">aes</span>(<span class="dt">x =</span> prec, <span class="dt">y =</span> temp)) +
<span class="st">        </span><span class="kw">geom_point</span>(<span class="dt">colour =</span> <span class="ot">NA</span>) +
<span class="st">        </span><span class="kw">geom_point</span>(<span class="dt">data =</span> <span class="kw">subset</span>(clim, month ==<span class="st"> </span>i), <span class="dt">pch =</span> <span class="dv">15</span>, 
            <span class="dt">colour =</span> <span class="kw">gray</span>(.<span class="dv">7</span>), <span class="dt">size =</span> <span class="dv">4</span>) +
<span class="st">        </span><span class="kw">geom_point</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(monthLocs[[i]]), <span class="dt">pch =</span> <span class="dv">20</span>) +
<span class="st">        </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x =</span> climMean$prec[i], <span class="dt">xend =</span> locsMean$prec[i], 
            <span class="dt">y =</span> climMean$temp[i], <span class="dt">yend =</span> locsMean$temp[i]), <span class="dt">arrow =</span> <span class="kw">arrow</span>(), 
            <span class="dt">lineend =</span> <span class="st">&quot;round&quot;</span>, <span class="dt">size =</span> <span class="fl">4.5</span>, <span class="dt">arrow.fill =</span> <span class="st">&quot;white&quot;</span>) +
<span class="st">        </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x =</span> climMean$prec[i], <span class="dt">xend =</span> locsMean$prec[i], 
            <span class="dt">y =</span> climMean$temp[i], <span class="dt">yend =</span> locsMean$temp[i]), <span class="dt">arrow =</span> <span class="kw">arrow</span>(), 
            <span class="dt">lineend =</span> <span class="st">&quot;round&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">colour =</span> <span class="st">&quot;white&quot;</span>) +
<span class="st">        </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">185</span>, <span class="dt">y =</span> <span class="dv">18</span>, <span class="dt">hjust =</span> <span class="dv">0</span>, <span class="dt">vjust =</span> <span class="dv">0</span>, 
            <span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">label =</span> month.name[i]) +
<span class="st">        </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Precipitation (mm)&quot;</span>,
            <span class="dt">y =</span> <span class="kw">expression</span>(<span class="st">&quot;Temperature &quot;</span> ( degree~C)))
    <span class="kw">assign</span>(<span class="kw">paste0</span>(<span class="st">&quot;niche&quot;</span>, i),
        <span class="kw">plot_grid</span>(temp_legend, prec_legend, <span class="ot">NULL</span>, plot_list[[<span class="dv">1</span>]], 
        plot_list[[<span class="dv">2</span>]], plot_list[[<span class="dv">3</span>]], <span class="dt">rel_heights =</span> <span class="kw">c</span>(.<span class="dv">15</span>, <span class="dv">1</span>), 
        <span class="dt">rel_widths =</span> <span class="kw">c</span>(<span class="fl">1.2</span>, <span class="fl">1.2</span>, <span class="dv">1</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">3</span>))
    ## cowplot::ggsave(paste0(&quot;Figures/niche-&quot;, i, &quot;.png&quot;), 
    ##     width = 7*3.4, height = 8.05)
    ## cowplot::ggsave(paste0(&quot;Figures/niche-&quot;, i, &quot;-web.png&quot;), 
    ##     width = 7*3.4, height = 8.05, dpi = 75)
    <span class="kw">assign</span>(<span class="kw">paste0</span>(<span class="st">&quot;g&quot;</span>, i, <span class="st">&quot;t&quot;</span>), plot_list[[<span class="dv">1</span>]])
    <span class="kw">assign</span>(<span class="kw">paste0</span>(<span class="st">&quot;g&quot;</span>, i, <span class="st">&quot;p&quot;</span>), plot_list[[<span class="dv">2</span>]])
}

## Figure with January-May-August-October
g1nAU &lt;-<span class="st"> </span><span class="kw">ggplot</span>(clim, <span class="kw">aes</span>(<span class="dt">x =</span> prec, <span class="dt">y =</span> temp)) +
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">colour =</span> <span class="ot">NA</span>) +
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">data =</span> <span class="kw">subset</span>(clim, month ==<span class="st"> </span><span class="dv">1</span>), <span class="dt">pch =</span> <span class="dv">15</span>, 
        <span class="dt">colour =</span> <span class="kw">gray</span>(.<span class="dv">7</span>), <span class="dt">size =</span> <span class="dv">4</span>) +
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(monthLocs[[<span class="dv">1</span>]]), <span class="dt">pch =</span> <span class="dv">20</span>) +
<span class="st">    </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x =</span> climMean$prec[<span class="dv">1</span>], <span class="dt">xend =</span> locsMean$prec[<span class="dv">1</span>], 
        <span class="dt">y =</span> climMean$temp[<span class="dv">1</span>], <span class="dt">yend =</span> locsMean$temp[<span class="dv">1</span>]), <span class="dt">arrow =</span> <span class="kw">arrow</span>(), 
        <span class="dt">lineend =</span> <span class="st">&quot;round&quot;</span>, <span class="dt">size =</span> <span class="fl">4.5</span>, <span class="dt">arrow.fill =</span> <span class="st">&quot;white&quot;</span>) +
<span class="st">    </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x =</span> climMean$prec[<span class="dv">1</span>], <span class="dt">xend =</span> locsMean$prec[<span class="dv">1</span>], 
        <span class="dt">y =</span> climMean$temp[<span class="dv">1</span>], <span class="dt">yend =</span> locsMean$temp[<span class="dv">1</span>]), <span class="dt">arrow =</span> <span class="kw">arrow</span>(), 
        <span class="dt">lineend =</span> <span class="st">&quot;round&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">colour =</span> <span class="st">&quot;white&quot;</span>) +
<span class="st">    </span><span class="kw">geom_label</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">c</span>(climMean$prec[<span class="dv">1</span>] -<span class="st"> </span><span class="dv">15</span>, locsMean$prec[<span class="dv">1</span>] +<span class="st"> </span><span class="dv">25</span>), 
        <span class="dt">y =</span> <span class="kw">c</span>(climMean$temp[<span class="dv">1</span>] -<span class="st"> </span><span class="dv">1</span>, locsMean$temp[<span class="dv">1</span>] +<span class="st"> </span>.<span class="dv">7</span>), <span class="dt">label =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;U&quot;</span>)), 
        <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">label =</span> label), <span class="dt">fill =</span> <span class="kw">c</span>(<span class="kw">gray</span>(.<span class="dv">9</span>), <span class="st">&quot;black&quot;</span>), 
        <span class="dt">colour =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;white&quot;</span>), <span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">fontface =</span> <span class="st">&quot;bold&quot;</span>) +
<span class="st">    </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">185</span>, <span class="dt">y =</span> <span class="dv">18</span>, <span class="dt">hjust =</span> <span class="dv">0</span>, <span class="dt">vjust =</span> <span class="dv">0</span>, <span class="dt">size =</span> <span class="dv">10</span>, 
        <span class="dt">label =</span> month.name[<span class="dv">1</span>]) +
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Precipitation (mm)&quot;</span>,
        <span class="dt">y =</span> <span class="kw">expression</span>(<span class="st">&quot;Temperature &quot;</span> ( degree~C)))
g5nAU &lt;-<span class="st"> </span><span class="kw">ggplot</span>(clim, <span class="kw">aes</span>(<span class="dt">x =</span> prec, <span class="dt">y =</span> temp)) +
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">colour =</span> <span class="ot">NA</span>) +
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">data =</span> <span class="kw">subset</span>(clim, month ==<span class="st"> </span><span class="dv">5</span>), <span class="dt">pch =</span> <span class="dv">15</span>, 
        <span class="dt">colour =</span> <span class="kw">gray</span>(.<span class="dv">7</span>), <span class="dt">size =</span> <span class="dv">4</span>) +
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(monthLocs[[<span class="dv">5</span>]]), <span class="dt">pch =</span> <span class="dv">20</span>) +
<span class="st">    </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x =</span> climMean$prec[<span class="dv">5</span>], <span class="dt">xend =</span> locsMean$prec[<span class="dv">5</span>], 
        <span class="dt">y =</span> climMean$temp[<span class="dv">5</span>], <span class="dt">yend =</span> locsMean$temp[<span class="dv">5</span>]), <span class="dt">arrow =</span> <span class="kw">arrow</span>(), 
        <span class="dt">lineend =</span> <span class="st">&quot;round&quot;</span>, <span class="dt">size =</span> <span class="fl">4.5</span>, <span class="dt">arrow.fill =</span> <span class="st">&quot;white&quot;</span>) +
<span class="st">    </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x =</span> climMean$prec[<span class="dv">5</span>], <span class="dt">xend =</span> locsMean$prec[<span class="dv">5</span>], 
        <span class="dt">y =</span> climMean$temp[<span class="dv">5</span>], <span class="dt">yend =</span> locsMean$temp[<span class="dv">5</span>]), <span class="dt">arrow =</span> <span class="kw">arrow</span>(), 
        <span class="dt">lineend =</span> <span class="st">&quot;round&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">colour =</span> <span class="st">&quot;white&quot;</span>) +
<span class="st">    </span><span class="kw">geom_label</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">c</span>(climMean$prec[<span class="dv">5</span>], locsMean$prec[<span class="dv">5</span>] +<span class="st"> </span><span class="dv">5</span>), 
        <span class="dt">y =</span> <span class="kw">c</span>(climMean$temp[<span class="dv">5</span>] -<span class="st"> </span><span class="dv">2</span>, locsMean$temp[<span class="dv">5</span>] +<span class="st"> </span><span class="dv">2</span>), <span class="dt">label =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;U&quot;</span>)), 
        <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">label =</span> label), <span class="dt">fill =</span> <span class="kw">c</span>(<span class="kw">gray</span>(.<span class="dv">9</span>), <span class="st">&quot;black&quot;</span>), 
        <span class="dt">colour =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;white&quot;</span>), <span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">fontface =</span> <span class="st">&quot;bold&quot;</span>) +
<span class="st">    </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">185</span>, <span class="dt">y =</span> <span class="dv">18</span>, <span class="dt">hjust =</span> <span class="dv">0</span>, <span class="dt">vjust =</span> <span class="dv">0</span>, <span class="dt">size =</span> <span class="dv">10</span>, 
        <span class="dt">label =</span> month.name[<span class="dv">5</span>]) +
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Precipitation (mm)&quot;</span>,
        <span class="dt">y =</span> <span class="kw">expression</span>(<span class="st">&quot;Temperature &quot;</span> ( degree~C)))
g8nAU &lt;-<span class="st"> </span><span class="kw">ggplot</span>(clim, <span class="kw">aes</span>(<span class="dt">x =</span> prec, <span class="dt">y =</span> temp)) +
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">colour =</span> <span class="ot">NA</span>) +
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">data =</span> <span class="kw">subset</span>(clim, month ==<span class="st"> </span><span class="dv">8</span>), <span class="dt">pch =</span> <span class="dv">15</span>, 
        <span class="dt">colour =</span> <span class="kw">gray</span>(.<span class="dv">7</span>), <span class="dt">size =</span> <span class="dv">4</span>) +
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(monthLocs[[<span class="dv">8</span>]]), <span class="dt">pch =</span> <span class="dv">20</span>) +
<span class="st">    </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x =</span> climMean$prec[<span class="dv">8</span>], <span class="dt">xend =</span> locsMean$prec[<span class="dv">8</span>], 
        <span class="dt">y =</span> climMean$temp[<span class="dv">8</span>], <span class="dt">yend =</span> locsMean$temp[<span class="dv">8</span>]), <span class="dt">arrow =</span> <span class="kw">arrow</span>(), 
        <span class="dt">lineend =</span> <span class="st">&quot;round&quot;</span>, <span class="dt">size =</span> <span class="fl">4.5</span>, <span class="dt">arrow.fill =</span> <span class="st">&quot;white&quot;</span>) +
<span class="st">    </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x =</span> climMean$prec[<span class="dv">8</span>], <span class="dt">xend =</span> locsMean$prec[<span class="dv">8</span>], 
        <span class="dt">y =</span> climMean$temp[<span class="dv">8</span>], <span class="dt">yend =</span> locsMean$temp[<span class="dv">8</span>]), <span class="dt">arrow =</span> <span class="kw">arrow</span>(), 
        <span class="dt">lineend =</span> <span class="st">&quot;round&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">colour =</span> <span class="st">&quot;white&quot;</span>) +
<span class="st">    </span><span class="kw">geom_label</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">c</span>(climMean$prec[<span class="dv">8</span>] -<span class="st"> </span><span class="dv">5</span>, locsMean$prec[<span class="dv">8</span>] +<span class="st"> </span><span class="dv">5</span>), 
        <span class="dt">y =</span> <span class="kw">c</span>(climMean$temp[<span class="dv">8</span>] -<span class="st"> </span><span class="dv">2</span>, locsMean$temp[<span class="dv">8</span>] -<span class="st"> </span><span class="dv">2</span>), <span class="dt">label =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;U&quot;</span>)), 
        <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">label =</span> label), <span class="dt">fill =</span> <span class="kw">c</span>(<span class="kw">gray</span>(.<span class="dv">9</span>), <span class="st">&quot;black&quot;</span>), 
        <span class="dt">colour =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;white&quot;</span>), <span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">fontface =</span> <span class="st">&quot;bold&quot;</span>) +
<span class="st">    </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">185</span>, <span class="dt">y =</span> <span class="dv">18</span>, <span class="dt">hjust =</span> <span class="dv">0</span>, <span class="dt">vjust =</span> <span class="dv">0</span>, <span class="dt">size =</span> <span class="dv">10</span>, 
        <span class="dt">label =</span> month.name[<span class="dv">8</span>]) +
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Precipitation (mm)&quot;</span>,
        <span class="dt">y =</span> <span class="kw">expression</span>(<span class="st">&quot;Temperature &quot;</span> ( degree~C)))
g10nAU &lt;-<span class="st"> </span><span class="kw">ggplot</span>(clim, <span class="kw">aes</span>(<span class="dt">x =</span> prec, <span class="dt">y =</span> temp)) +
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">colour =</span> <span class="ot">NA</span>) +
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">data =</span> <span class="kw">subset</span>(clim, month ==<span class="st"> </span><span class="dv">10</span>), <span class="dt">pch =</span> <span class="dv">15</span>, 
        <span class="dt">colour =</span> <span class="kw">gray</span>(.<span class="dv">7</span>), <span class="dt">size =</span> <span class="dv">4</span>) +
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(monthLocs[[<span class="dv">10</span>]]), <span class="dt">pch =</span> <span class="dv">20</span>) +
<span class="st">    </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x =</span> climMean$prec[<span class="dv">10</span>], <span class="dt">xend =</span> locsMean$prec[<span class="dv">10</span>], 
        <span class="dt">y =</span> climMean$temp[<span class="dv">10</span>], <span class="dt">yend =</span> locsMean$temp[<span class="dv">10</span>]), <span class="dt">arrow =</span> <span class="kw">arrow</span>(), 
        <span class="dt">lineend =</span> <span class="st">&quot;round&quot;</span>, <span class="dt">size =</span> <span class="fl">4.5</span>, <span class="dt">arrow.fill =</span> <span class="st">&quot;white&quot;</span>) +
<span class="st">    </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x =</span> climMean$prec[<span class="dv">10</span>], <span class="dt">xend =</span> locsMean$prec[<span class="dv">10</span>], 
        <span class="dt">y =</span> climMean$temp[<span class="dv">10</span>], <span class="dt">yend =</span> locsMean$temp[<span class="dv">10</span>]), <span class="dt">arrow =</span> <span class="kw">arrow</span>(), 
        <span class="dt">lineend =</span> <span class="st">&quot;round&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">colour =</span> <span class="st">&quot;white&quot;</span>) +
<span class="st">    </span><span class="kw">geom_label</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">c</span>(climMean$prec[<span class="dv">10</span>] +<span class="st"> </span><span class="dv">20</span>, locsMean$prec[<span class="dv">10</span>] +<span class="st"> </span><span class="dv">20</span>), 
        <span class="dt">y =</span> <span class="kw">c</span>(climMean$temp[<span class="dv">10</span>] -<span class="st"> </span>.<span class="dv">7</span>, locsMean$temp[<span class="dv">10</span>] -<span class="st"> </span>.<span class="dv">7</span>), <span class="dt">label =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;U&quot;</span>)), 
        <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">label =</span> label), <span class="dt">fill =</span> <span class="kw">c</span>(<span class="kw">gray</span>(.<span class="dv">9</span>), <span class="st">&quot;black&quot;</span>), 
        <span class="dt">colour =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;white&quot;</span>), <span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">fontface =</span> <span class="st">&quot;bold&quot;</span>) +
<span class="st">    </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">185</span>, <span class="dt">y =</span> <span class="dv">18</span>, <span class="dt">hjust =</span> <span class="dv">0</span>, <span class="dt">vjust =</span> <span class="dv">0</span>, <span class="dt">size =</span> <span class="dv">10</span>, 
        <span class="dt">label =</span> month.name[<span class="dv">10</span>]) +
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Precipitation (mm)&quot;</span>,
        <span class="dt">y =</span> <span class="kw">expression</span>(<span class="st">&quot;Temperature &quot;</span> ( degree~C)))

<span class="kw">plot_grid</span>(temp_legend, prec_legend, <span class="ot">NULL</span>, g1t, g1p, g1nAU, g5t, g5p, 
    g5nAU, g8t, g8p, g8nAU, g10t, g10p, g10nAU, <span class="dt">nrow =</span> <span class="dv">5</span>, <span class="dt">ncol =</span> <span class="dv">3</span>, 
    <span class="dt">rel_widths =</span> <span class="kw">c</span>(<span class="fl">1.2</span>, <span class="fl">1.2</span>, <span class="dv">1</span>), <span class="dt">rel_heights =</span>  <span class="kw">c</span>(.<span class="dv">15</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))

cowplot::<span class="kw">ggsave</span>(<span class="st">&quot;Figures/niche-print.png&quot;</span>, <span class="dt">width =</span> <span class="dv">7</span>*<span class="fl">3.4</span>, <span class="dt">height =</span> <span class="dv">7</span>*<span class="dv">4</span><span class="fl">+1.05</span>, 
    <span class="dt">dpi =</span> <span class="dv">150</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:figure-monthly"></span>
<img src="_main_files/figure-html/figure-monthly-1.png" alt="Wood stork monthly range (left and center) and climatic niche (right) during January, May, August and October.  Range maps show current GPS locations in a given month in black with kernel contour lines, and all locations from the entire dataset shown as a reference in gray, on a background of temperature (left, from blue for colder temperatures to red for warmer temperatures) or precipitations (center, from yellow for dry conditions to blue for wet conditions). Climatic niches show current conditions used in a given month (precipitation on the X-axis, and temperature on the Y-axis) in black, in comparison to conditions available in the study area in a given month in gray. The marginality arrow defines the difference between average available conditions (&quot;A&quot;) and average used conditions (&quot;U&quot;)." width="100%" />
<p class="caption">
Figure 4.1: Wood stork monthly range (left and center) and climatic niche (right) during January, May, August and October. Range maps show current GPS locations in a given month in black with kernel contour lines, and all locations from the entire dataset shown as a reference in gray, on a background of temperature (left, from blue for colder temperatures to red for warmer temperatures) or precipitations (center, from yellow for dry conditions to blue for wet conditions). Climatic niches show current conditions used in a given month (precipitation on the X-axis, and temperature on the Y-axis) in black, in comparison to conditions available in the study area in a given month in gray. The marginality arrow defines the difference between average available conditions (“A”) and average used conditions (“U”).
</p>
</div>
</div>
<div id="fig.2-overlap-matrices" class="section level2">
<h2><span class="header-section-number">4.2</span> Fig.2: Overlap matrices</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="fl">0.1</span>) +<span class="st"> </span><span class="fl">0.4</span>, <span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))
<span class="kw">image</span>(<span class="dt">x =</span> <span class="dv">1</span>:<span class="dv">12</span>, <span class="dt">y =</span> <span class="dv">1</span>:<span class="dv">12</span>, overGeo, <span class="dt">asp =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="kw">viridis</span>(<span class="dv">100</span>, <span class="dt">direction =</span> -<span class="dv">1</span>, 
    <span class="dt">option =</span> <span class="st">&quot;plasma&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>), <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">cex.lab =</span> <span class="fl">1.5</span>)
<span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at =</span> <span class="dv">1</span>:<span class="dv">12</span>, <span class="dt">labels =</span> month.abb, <span class="dt">tick =</span> <span class="ot">FALSE</span>, <span class="dt">line =</span> -<span class="fl">0.7</span>)
<span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">at =</span> <span class="dv">1</span>:<span class="dv">12</span>, <span class="dt">labels =</span> month.abb, <span class="dt">tick =</span> <span class="ot">FALSE</span>, <span class="dt">line =</span> -<span class="fl">0.7</span>)
<span class="kw">mtext</span>(<span class="st">&quot;Month&quot;</span>, <span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">line =</span> <span class="dv">2</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>)
<span class="kw">mtext</span>(<span class="st">&quot;Month&quot;</span>, <span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">line =</span> <span class="fl">1.7</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>)
<span class="kw">mtext</span>(<span class="st">&quot;A) Geographic overlap&quot;</span>, <span class="dt">side =</span> <span class="dv">3</span>, <span class="dt">line =</span> <span class="fl">0.6</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>)
lab &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">x =</span> <span class="dv">1</span>:<span class="dv">12</span>, <span class="dt">y =</span> <span class="dv">1</span>:<span class="dv">12</span>)
lab$val &lt;-<span class="st"> </span><span class="kw">as.vector</span>(<span class="kw">round</span>(overGeo *<span class="st"> </span><span class="dv">100</span>, <span class="dv">0</span>))
<span class="kw">text</span>(lab$x, lab$y, lab$val, <span class="dt">cex =</span> <span class="dv">1</span> +<span class="st"> </span>(lab$val -<span class="st"> </span><span class="dv">50</span>)/<span class="dv">100</span>, <span class="dt">col =</span> <span class="kw">ifelse</span>(lab$val &gt;=<span class="st"> </span>
<span class="st">    </span><span class="dv">80</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;black&quot;</span>))
<span class="kw">polygon</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>:<span class="dv">12</span> +<span class="st"> </span><span class="fl">0.5</span>, <span class="dt">each =</span> <span class="dv">2</span>), <span class="kw">rep</span>(<span class="dv">11</span>:<span class="dv">1</span> +<span class="st"> </span><span class="fl">0.5</span>, <span class="dt">each =</span> <span class="dv">2</span>), <span class="fl">0.5</span>), <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">1</span>, 
    <span class="kw">rep</span>(<span class="dv">0</span>:<span class="dv">11</span> +<span class="st"> </span><span class="fl">0.5</span>, <span class="dt">each =</span> <span class="dv">2</span>), <span class="kw">rep</span>(<span class="dv">12</span>:<span class="dv">1</span> +<span class="st"> </span><span class="fl">0.5</span>, <span class="dt">each =</span> <span class="dv">2</span>)), <span class="dt">col =</span> <span class="kw">grey</span>(<span class="fl">0.7</span>), 
    <span class="dt">border =</span> <span class="ot">NA</span>)
<span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">c</span>(<span class="fl">3.5</span>, <span class="fl">10.5</span>), <span class="dt">v =</span> <span class="kw">c</span>(<span class="fl">3.5</span>, <span class="fl">10.5</span>), <span class="dt">lwd =</span> <span class="dv">4</span>)
<span class="kw">lines</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">2</span>) +<span class="st"> </span><span class="fl">0.5</span>, <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">0</span>) +<span class="st"> </span><span class="fl">0.5</span>, <span class="dt">lwd =</span> <span class="dv">4</span>, <span class="dt">lty =</span> <span class="st">&quot;11&quot;</span>)
<span class="kw">lines</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">2</span>) +<span class="st"> </span><span class="fl">0.5</span>, <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">12</span>) +<span class="st"> </span><span class="fl">0.5</span>, <span class="dt">lwd =</span> <span class="dv">4</span>, <span class="dt">lty =</span> <span class="st">&quot;11&quot;</span>)
<span class="kw">polygon</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">9</span>, <span class="dv">5</span>) +<span class="st"> </span><span class="fl">0.5</span>, <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">9</span>) +<span class="st"> </span><span class="fl">0.5</span>, <span class="dt">lwd =</span> <span class="dv">4</span>, <span class="dt">lty =</span> <span class="st">&quot;11&quot;</span>)
<span class="kw">lines</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">12</span>) +<span class="st"> </span><span class="fl">0.5</span>, <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">12</span>, <span class="dv">10</span>, <span class="dv">10</span>) +<span class="st"> </span><span class="fl">0.5</span>, <span class="dt">lwd =</span> <span class="dv">4</span>, <span class="dt">lty =</span> <span class="st">&quot;11&quot;</span>)
<span class="kw">lines</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">12</span>) +<span class="st"> </span><span class="fl">0.5</span>, <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">2</span>) +<span class="st"> </span><span class="fl">0.5</span>, <span class="dt">lwd =</span> <span class="dv">4</span>, <span class="dt">lty =</span> <span class="st">&quot;11&quot;</span>)
<span class="kw">image</span>(<span class="dt">x =</span> <span class="dv">1</span>:<span class="dv">12</span>, <span class="dt">y =</span> <span class="dv">1</span>:<span class="dv">12</span>, overClim, <span class="dt">asp =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="kw">viridis</span>(<span class="dv">100</span>, <span class="dt">direction =</span> -<span class="dv">1</span>, 
    <span class="dt">option =</span> <span class="st">&quot;plasma&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>), <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">cex.lab =</span> <span class="fl">1.5</span>)
<span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at =</span> <span class="dv">1</span>:<span class="dv">12</span>, <span class="dt">labels =</span> month.abb, <span class="dt">tick =</span> <span class="ot">FALSE</span>, <span class="dt">line =</span> -<span class="fl">0.7</span>)
<span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">at =</span> <span class="dv">1</span>:<span class="dv">12</span>, <span class="dt">labels =</span> month.abb, <span class="dt">tick =</span> <span class="ot">FALSE</span>, <span class="dt">line =</span> -<span class="fl">0.7</span>)
<span class="kw">mtext</span>(<span class="st">&quot;Month&quot;</span>, <span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">line =</span> <span class="dv">2</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>)
<span class="kw">mtext</span>(<span class="st">&quot;Month&quot;</span>, <span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">line =</span> <span class="fl">1.7</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>)
<span class="kw">mtext</span>(<span class="st">&quot;B) Climatic overlap&quot;</span>, <span class="dt">side =</span> <span class="dv">3</span>, <span class="dt">line =</span> <span class="fl">0.6</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>)
lab &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">x =</span> <span class="dv">1</span>:<span class="dv">12</span>, <span class="dt">y =</span> <span class="dv">1</span>:<span class="dv">12</span>)
lab$val &lt;-<span class="st"> </span><span class="kw">as.vector</span>(<span class="kw">round</span>(overClim *<span class="st"> </span><span class="dv">100</span>, <span class="dv">0</span>))
<span class="kw">text</span>(lab$x, lab$y, lab$val, <span class="dt">cex =</span> <span class="dv">1</span> +<span class="st"> </span>(lab$val -<span class="st"> </span><span class="dv">50</span>)/<span class="dv">100</span>, <span class="dt">col =</span> <span class="kw">ifelse</span>(lab$val &gt;=<span class="st"> </span>
<span class="st">    </span><span class="dv">90</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;black&quot;</span>))
<span class="kw">polygon</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>:<span class="dv">12</span> +<span class="st"> </span><span class="fl">0.5</span>, <span class="dt">each =</span> <span class="dv">2</span>), <span class="kw">rep</span>(<span class="dv">11</span>:<span class="dv">1</span> +<span class="st"> </span><span class="fl">0.5</span>, <span class="dt">each =</span> <span class="dv">2</span>), <span class="fl">0.5</span>), <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">1</span>, 
    <span class="kw">rep</span>(<span class="dv">0</span>:<span class="dv">11</span> +<span class="st"> </span><span class="fl">0.5</span>, <span class="dt">each =</span> <span class="dv">2</span>), <span class="kw">rep</span>(<span class="dv">12</span>:<span class="dv">1</span> +<span class="st"> </span><span class="fl">0.5</span>, <span class="dt">each =</span> <span class="dv">2</span>)), <span class="dt">col =</span> <span class="kw">grey</span>(<span class="fl">0.7</span>), 
    <span class="dt">border =</span> <span class="ot">NA</span>)
<span class="kw">lines</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">2</span>) +<span class="st"> </span><span class="fl">0.5</span>, <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">0</span>) +<span class="st"> </span><span class="fl">0.5</span>, <span class="dt">lwd =</span> <span class="dv">4</span>)
<span class="kw">lines</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">2</span>) +<span class="st"> </span><span class="fl">0.5</span>, <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">12</span>) +<span class="st"> </span><span class="fl">0.5</span>, <span class="dt">lwd =</span> <span class="dv">4</span>)
<span class="kw">polygon</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">9</span>, <span class="dv">5</span>) +<span class="st"> </span><span class="fl">0.5</span>, <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">9</span>) +<span class="st"> </span><span class="fl">0.5</span>, <span class="dt">lwd =</span> <span class="dv">4</span>)
<span class="kw">lines</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">12</span>) +<span class="st"> </span><span class="fl">0.5</span>, <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">12</span>, <span class="dv">10</span>, <span class="dv">10</span>) +<span class="st"> </span><span class="fl">0.5</span>, <span class="dt">lwd =</span> <span class="dv">4</span>)
<span class="kw">lines</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">12</span>) +<span class="st"> </span><span class="fl">0.5</span>, <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">2</span>) +<span class="st"> </span><span class="fl">0.5</span>, <span class="dt">lwd =</span> <span class="dv">4</span>)
<span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">c</span>(<span class="fl">3.5</span>, <span class="fl">10.5</span>), <span class="dt">v =</span> <span class="kw">c</span>(<span class="fl">3.5</span>, <span class="fl">10.5</span>), <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">lty =</span> <span class="st">&quot;11&quot;</span>)
<span class="kw">dev.copy2pdf</span>(<span class="dt">file =</span> <span class="st">&quot;Figures/overlap-both.pdf&quot;</span>, <span class="dt">width =</span> <span class="fl">13.25</span>, <span class="dt">height =</span> <span class="dv">7</span>)</code></pre></div>
<pre><code>## png 
##   2</code></pre>
<div class="figure" style="text-align: center"><span id="fig:figure-overlap"></span>
<img src="_main_files/figure-html/figure-overlap-1.png" alt="Matrices of A) geographic and B) climatic overlap during the year. Each matrix provides Bhattacharyya's affinity as a percentage (between 0 and 100, higher values corresponding to darker color), as a measure of overlap between two months $i$ (rows) and $j$ (columns). The main diagonal, where $i = j$ is grayed out as all values equal $1$. Consistent seasons in a given space are highlighted with a bold line, while seasons identified in the other space are highlighted with a dotted line for reference." width="100%" />
<p class="caption">
Figure 4.2: Matrices of A) geographic and B) climatic overlap during the year. Each matrix provides Bhattacharyya’s affinity as a percentage (between 0 and 100, higher values corresponding to darker color), as a measure of overlap between two months <span class="math inline">\(i\)</span> (rows) and <span class="math inline">\(j\)</span> (columns). The main diagonal, where <span class="math inline">\(i = j\)</span> is grayed out as all values equal <span class="math inline">\(1\)</span>. Consistent seasons in a given space are highlighted with a bold line, while seasons identified in the other space are highlighted with a dotted line for reference.
</p>
</div>
</div>
<div id="fig.3-marginality" class="section level2">
<h2><span class="header-section-number">4.3</span> Fig.3: Marginality</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mar, <span class="kw">aes</span>(<span class="dt">x =</span> prec, <span class="dt">y =</span> temp, <span class="dt">colour =</span> season, <span class="dt">fill =</span> season)) +
<span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>) +<span class="st"> </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>) +
<span class="st">    </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">y =</span> <span class="dv">0</span>, <span class="dt">xend =</span> prec, <span class="dt">yend =</span> temp),
        <span class="dt">arrow =</span> <span class="kw">arrow</span>(), <span class="dt">lineend =</span> <span class="st">&quot;round&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>) +
<span class="st">    </span><span class="kw">geom_label_repel</span>(<span class="dt">data =</span> <span class="kw">subset</span>(mar, prec &lt;<span class="st"> </span><span class="dv">10</span>), <span class="kw">aes</span>(<span class="dt">label =</span> abbr),
        <span class="dt">size =</span> <span class="dv">6</span>, <span class="dt">direction =</span> <span class="st">&quot;x&quot;</span>, <span class="dt">nudge_y =</span> .<span class="dv">3</span>, <span class="dt">fontface =</span> <span class="st">&quot;bold&quot;</span>,
        <span class="dt">colour =</span> <span class="st">&quot;white&quot;</span>) +
<span class="st">    </span><span class="kw">geom_label_repel</span>(<span class="dt">data =</span> <span class="kw">subset</span>(mar, prec &gt;<span class="st"> </span><span class="dv">10</span>), <span class="kw">aes</span>(<span class="dt">label =</span> abbr),
        <span class="dt">size =</span> <span class="dv">6</span>, <span class="dt">direction =</span> <span class="st">&quot;both&quot;</span>, <span class="dt">nudge_x =</span> <span class="dv">3</span>, <span class="dt">force =</span> <span class="fl">0.015</span>,
        <span class="dt">fontface =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;white&quot;</span>) +
<span class="st">    </span><span class="kw">scale_color_viridis</span>(<span class="dt">end =</span> .<span class="dv">8</span>, <span class="dt">direction =</span> -<span class="dv">1</span>, <span class="dt">option =</span> <span class="st">&quot;plasma&quot;</span>) +
<span class="st">    </span><span class="kw">scale_fill_viridis</span>(<span class="dt">end =</span> .<span class="dv">8</span>, <span class="dt">direction =</span> -<span class="dv">1</span>, <span class="dt">option =</span> <span class="st">&quot;plasma&quot;</span>) +
<span class="st">    </span><span class="kw">xlim</span>(-<span class="dv">63</span>, <span class="dv">40</span>) +<span class="st"> </span><span class="kw">ylim</span>(<span class="dv">0</span>, <span class="fl">8.2</span>) +
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Precipitation difference (mm)&quot;</span>,
        <span class="dt">y =</span> <span class="kw">expression</span>(<span class="st">&quot;Temperature difference &quot;</span> ( degree~C))) +
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>)

cowplot::<span class="kw">ggsave</span>(<span class="st">&quot;Figures/marginality.pdf&quot;</span>)</code></pre></div>
<pre><code>## Saving 7 x 7 in image</code></pre>
<div class="figure" style="text-align: center"><span id="fig:figure-marginality"></span>
<img src="_main_files/figure-html/figure-marginality-1.png" alt="Seasonal variation in marginality, as measured by the difference between climatic conditions at wood stork GPS locations vs. the entire study area for each month. Each arrow represents selection in a given month for both precipitation (X-axis) and temperature (Y-axis): Wood storks select drier and warmer areas during the winter (November–April in fuchsia), wetter areas during the summer (June–September in dark blue), and intermediate conditions in transitional seasons (May and October in orange)." width="50%" />
<p class="caption">
Figure 4.3: Seasonal variation in marginality, as measured by the difference between climatic conditions at wood stork GPS locations vs. the entire study area for each month. Each arrow represents selection in a given month for both precipitation (X-axis) and temperature (Y-axis): Wood storks select drier and warmer areas during the winter (November–April in fuchsia), wetter areas during the summer (June–September in dark blue), and intermediate conditions in transitional seasons (May and October in orange).
</p>
</div>
</div>
<div id="metadata-s1-animation-over-the-year" class="section level2">
<h2><span class="header-section-number">4.4</span> Metadata S1: Animation over the year</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;magick&quot;</span>)
img &lt;-<span class="st"> </span><span class="kw">image_graph</span>(<span class="dv">1785</span>, <span class="dv">603</span>)
niche1
niche2
niche3
niche4
niche5
niche6
niche7
niche8
niche9
niche10
niche11
niche12
<span class="kw">dev.off</span>()
animation &lt;-<span class="st"> </span><span class="kw">image_animate</span>(img, <span class="dt">fps =</span> <span class="dv">1</span>/<span class="fl">1.5</span>)
<span class="kw">image_write</span>(animation, <span class="st">&quot;Figures/niche-anim.gif&quot;</span>)
<span class="kw">system</span>(<span class="st">&quot;convert Figures/niche-anim.gif Figures/niche-anim.mp4&quot;</span>)
<span class="kw">system</span>(<span class="st">&quot;convert Figures/niche-anim.gif Figures/niche-anim.mov&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr::<span class="kw">include_graphics</span>(<span class="st">&quot;Figures/niche-anim.gif&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:figure-niche-anim-plot"></span>
<img src="Figures/niche-anim.gif" alt="In this animation (available as 'Video_S1.gif', 'Video_S1.mp4', and 'Video_S1.mov'), each panel presents wood stork monthly ranges (left and center) and climatic niche (right) during the year. Range maps show current GPS locations in a given month in black with kernel contour lines, and all locations from the entire dataset shown as a reference in gray, on a background of temperature (left, from blue for colder temperatures to red for warmer temperatures) or precipitations (center, from yellow for dry conditions to blue for wet conditions). Climatic niches show current conditions used in a given month (precipitation on the X-axis, and temperature on the Y-axis) in black, in comparison to conditions available in the study area in a given month in gray. The marginality arrow defines the difference between average available conditions and average used conditions." width="100%" />
<p class="caption">
Figure 4.4: In this animation (available as ‘Video_S1.gif’, ‘Video_S1.mp4’, and ‘Video_S1.mov’), each panel presents wood stork monthly ranges (left and center) and climatic niche (right) during the year. Range maps show current GPS locations in a given month in black with kernel contour lines, and all locations from the entire dataset shown as a reference in gray, on a background of temperature (left, from blue for colder temperatures to red for warmer temperatures) or precipitations (center, from yellow for dry conditions to blue for wet conditions). Climatic niches show current conditions used in a given month (precipitation on the X-axis, and temperature on the Y-axis) in black, in comparison to conditions available in the study area in a given month in gray. The marginality arrow defines the difference between average available conditions and average used conditions.
</p>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="niches.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="session.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
